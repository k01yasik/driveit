(self.webpackChunk=self.webpackChunk||[]).push([[773],{1778:(e,t)=>{"use strict";t.__esModule=!0,t.DomUtils=void 0;var n=function(){function e(){}return e.fadeOut=function(e,t,n){e.style.transition="opacity ".concat(t,"ms"),e.style.opacity="0",setTimeout((function(){e.remove(),null==n||n()}),t)},e.fadeIn=function(e,t){e.style.opacity="0",e.style.display="block",e.style.transition="opacity ".concat(t,"ms"),e.offsetHeight,e.style.opacity="1"},e}();t.DomUtils=n},6632:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.FriendRequestApiService=void 0;var o=function(){function e(){}return e.sendRequest=function(e,t,o){return void 0===o&&(o="/user/friends/requests"),n(this,void 0,void 0,(function(){var n,a;return r(this,(function(r){switch(r.label){case 0:return(n=new FormData).append("id",e),n.append("username",t),a=this.getCsrfToken(),[4,fetch(o,{method:"POST",headers:{"X-CSRF-TOKEN":a},body:n})];case 1:if(!r.sent().ok)throw new Error("Failed to process friend request");return[2]}}))}))},e.getCsrfToken=function(){var e,t=null===(e=document.querySelector('meta[name="csrf-token"]'))||void 0===e?void 0:e.content;if(!t)throw new Error("CSRF token not found");return t},e}();t.FriendRequestApiService=o},8475:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.FriendRequestHandler=void 0;var i=n(6632),s=n(2390),c=function(){function e(){}return e.init=function(e){var t;void 0===e&&(e={}),this.options=r(r({},this.options),e),null===(t=document.querySelector(this.options.containerSelector))||void 0===t||t.addEventListener("click",this.handleRequest.bind(this))},e.handleRequest=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o,c;return a(this,(function(a){switch(a.label){case 0:if(!(t=e.target.closest(this.options.buttonSelector)))return[2];e.preventDefault(),a.label=1;case 1:return a.trys.push([1,3,,4]),n=t.dataset,r=n.id,o=n.username,r&&o?[4,i.FriendRequestApiService.sendRequest(r,o,this.options.apiUrl)]:[2];case 2:return a.sent(),s.FriendRequestUI.updateUI(t,this.options.uiOptions),[3,4];case 3:return c=a.sent(),console.error("Friend request error:",c),[3,4];case 4:return[2]}}))}))},e.options={apiUrl:"/user/friends/requests",buttonSelector:".friend-request-button",containerSelector:".request-list",uiOptions:{counterSelector:".friend-requests",parentSelector:".request-list > *",emptyStateSelector:".request-list-element"}},e}();t.FriendRequestHandler=c},2390:(e,t,n)=>{"use strict";t.__esModule=!0,t.FriendRequestUI=void 0;var r=n(1778),o=function(){function e(){}return e.updateUI=function(e,t){var n;void 0===t&&(t={});var r=t.counterSelector,o=void 0===r?".friend-requests":r,a=t.parentSelector,i=void 0===a?".request-list > *":a,s=t.emptyStateSelector,c=void 0===s?".request-list-element":s;this.setCheckmarkIcon(e);var u=document.querySelector(o),l=u?parseInt((null===(n=u.textContent)||void 0===n?void 0:n.replace("+",""))||"0"):0;this.updateCounter(u,l),this.handleParentElement(e,i,c,l)},e.setCheckmarkIcon=function(e){e.innerHTML='\n            <svg version="1.1" class="public-user-check" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26">\n                <path d="m.3,14c-0.2-0.2-0.3-0.5-0.3-0.7s0.1-0.5 0.3-0.7l1.4-1.4c0.4-0.4 1-0.4 1.4,0l.1,.1 5.5,5.9c0.2,0.2 0.5,0.2 0.7,0l13.4-13.9h0.1v-8.88178e-16c0.4-0.4 1-0.4 1.4,0l1.4,1.4c0.4,0.4 0.4,1 0,1.4l0,0-16,16.6c-0.2,0.2-0.4,0.3-0.7,0.3-0.3,0-0.5-0.1-0.7-0.3l-7.8-8.4-.2-.3z"></path>\n            </svg>\n        '},e.updateCounter=function(e,t){if(e){var n=t-1;n>0?e.textContent="+".concat(n):r.DomUtils.fadeOut(e,500)}},e.handleParentElement=function(e,t,n,o){var a=e.closest(t);a&&r.DomUtils.fadeOut(a,500,(function(){if(o<=1){var e=document.querySelector(n);e&&r.DomUtils.fadeIn(e,500)}}))},e}();t.FriendRequestUI=o},4505:(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(8475);document.addEventListener("DOMContentLoaded",(function(){r.FriendRequestHandler.init()}))},9938:(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(6240);document.addEventListener("DOMContentLoaded",(function(){new r.CommentController}))},5747:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},n=this,r=document.getElementById("upload_image_to_album_input"),o=document.querySelectorAll(".add-image-button"),a=document.querySelector(".image-progress"),i=document.querySelector(".no-images"),s=document.querySelector(".image-wrapper"),c=document.querySelector('meta[name="csrf-token"]'),u=(null==c?void 0:c.content)||"",l=function(){r&&r.click()},d=function(e){var t=e[1],n=e[2],r=e[3],o=e[4];return'\n  <div class="image-block">\n    <div class="image-block-top">\n      <div class="image-block-top-button" data-id="'.concat(n,'" data-username="').concat(r,'" data-album="').concat(o,'">\n        <svg version="1.1" class="image-block-button-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 94.926 94.926">\n          <g>\n            <path d="M55.931,47.463L94.306,9.09c0.826-0.827,0.826-2.167,0-2.994L88.833,0.62C88.436,0.224,87.896,0,87.335,0\n            c-0.562,0-1.101,0.224-1.498,0.62L47.463,38.994L9.089,0.62c-0.795-0.795-2.202-0.794-2.995,0L0.622,6.096\n            c-0.827,0.827-0.827,2.167,0,2.994l38.374,38.373L0.622,85.836c-0.827,0.827-0.827,2.167,0,2.994l5.473,5.476\n            c0.397,0.396,0.936,0.62,1.498,0.62s1.1-0.224,1.497-0.62l38.374-38.374l38.374,38.374c0.397,0.396,0.937,0.62,1.498,0.62\n            s1.101-0.224,1.498-0.62l5.473-5.476c0.826-0.827,0.826-2.167,0-2.994L55.931,47.463z"></path>\n          </g>\n        </svg>\n      </div>\n    </div>\n    <img src="').concat(t,'" alt="Uploaded content" />\n    <div class="image-block-footer">\n      <div class="image-block-footer-counter">0</div>\n      <div class="image-block-footer-wrapper">\n        <div class="image-block-footer-button" data-id="').concat(n,'" data-username="').concat(r,'">\n          <svg version="1.1" class="heart-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 510 510">\n            <g>\n              <path d="M255,489.6l-35.7-35.7C86.7,336.6,0,257.55,0,160.65C0,81.6,61.2,20.4,140.25,20.4c43.35,0,86.7,20.4,114.75,53.55 \n              C283.05,40.8,326.4,20.4,369.75,20.4C448.8,20.4,510,81.6,510,160.65c0,96.9-86.7,175.95-219.3,293.25L255,489.6z"></path>\n            </g>\n          </svg>\n        </div>\n      </div>\n    </div>\n  </div>')};o.forEach((function(e){e.addEventListener("click",l)})),r&&r.addEventListener("change",(function(r){return e(n,void 0,void 0,(function(){var e,n,o,c,l,f,h,p;return t(this,(function(t){switch(t.label){case 0:if(!(e=r.target).files||0===e.files.length)return[2];a&&(a.style.display="block",a.value=0),n=e.dataset,o=n.name,c=n.username,l=new FormData,Array.from(e.files).forEach((function(e){l.append("images_upload[]",e)})),o&&l.append("album_name",o),c&&l.append("username",c),t.label=1;case 1:return t.trys.push([1,4,,5]),[4,fetch("/user/albums/image/upload",{method:"POST",headers:{"X-CSRF-TOKEN":u},body:l})];case 2:if(!(f=t.sent()).ok)throw new Error("Server returned status ".concat(f.status));return[4,f.json()];case 3:return function(e){if(i&&(i.style.display="none"),a&&(a.style.display="none",a.value=0),s&&"none"===s.style.display&&(s.style.display="flex"),s){var t=e.map(d).join("");s.insertAdjacentHTML("afterbegin",t)}}(t.sent()),[3,5];case 4:return h=t.sent(),p=h instanceof Error?h.message:"Unknown error",m=p,console.error("Upload error:",m),a&&(a.style.display="none",a.value=0),alert("Произошла ошибка при загрузке изображений. Пожалуйста, попробуйте снова."),[3,5];case 5:return[2]}var m}))}))}))},5427:(e,t,n)=>{"use strict";n(2781),n(8072),n(9342),n(1282),n(5774),n(4157),n(9938),n(844),n(5747),n(5274),n(7051),n(9916),n(9735),n(9404),n(1971),n(1251),n(4863),n(8480),n(2137),n(1809),n(5025),n(4158),n(4600),n(6058),n(4505),n(2210)},1251:()=>{new(function(){function e(e){this.scrollFrameId=null,this.animationFrameId=null;var t=document.querySelector(e);if(!t)throw new Error("Element ".concat(e," not found"));this.backButton=t,this.init()}return e.prototype.init=function(){var e=this;this.backButton.addEventListener("click",(function(t){return e.scrollToTop(t)})),window.addEventListener("scroll",(function(){return e.handleScroll()}))},e.prototype.handleScroll=function(){var e=this;this.scrollFrameId&&cancelAnimationFrame(this.scrollFrameId),this.scrollFrameId=requestAnimationFrame((function(){var t=window.scrollY>500;e.backButton.classList.toggle("back-to-top--visible",t)}))},e.prototype.scrollToTop=function(e){var t=this;e.preventDefault();var n=window.scrollY,r=Math.min(1e3,Math.max(800,.5*n)),o=performance.now(),a={duration:r,easing:this.easeOutQuad};this.animationFrameId=requestAnimationFrame((function e(r){var i=r-o,s=Math.min(i/a.duration,1),c=a.easing(s);window.scrollTo(0,n*(1-c)),t.animationFrameId=s<1?requestAnimationFrame(e):null}))},e.prototype.easeOutQuad=function(e){return e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2},e.prototype.destroy=function(){this.scrollFrameId&&cancelAnimationFrame(this.scrollFrameId),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.backButton.removeEventListener("click",this.scrollToTop),window.removeEventListener("scroll",this.handleScroll)},e}())(".back-to-top")},2781:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};t.__esModule=!0;var o=n(6486),a=n(9669),i=n(9755),s=n(4554),c=n(6809),u=n(9697),l=n(3328),d=n(8278),f=n(369);n(8414),n(1956),n(6682),window._=o.default,window.$=window.jQuery=i.default,window.axios=a.default,window.io=c.default,window.smartcrop=u.default,window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",window.axios.defaults.withCredentials=!0;var h=document.head.querySelector('meta[name="csrf-token"]');h&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=h.getAttribute("content")),l.Chart.register.apply(l.Chart,r(r([],l.registerables,!1),[d.default],!1)),window.Chart=l.Chart,window.Echo=new s.default({broadcaster:"socket.io",host:window.location.hostname}),(0,f.default)(".tippy",{theme:"material",arrow:f.roundArrow,duration:500,placement:"right"})},9735:()=>{!function(){function e(){this.channelId=this.getDataAttributeNumber(".channel","id"),this.postId=this.getDataAttributeNumber(".full-post","id")}e.prototype.initialize=function(){this.channelId&&this.setupPrivateChannel(),this.postId&&this.setupPostChannel()},e.prototype.getDataAttributeNumber=function(e,t){var n=document.querySelector(e);if(!n)return null;var r=n.getAttribute("data-".concat(t));return r?parseInt(r,10):null},e.prototype.setupPrivateChannel=function(){var e=this;this.channelId&&window.Echo.private("user.".concat(this.channelId)).listen("MessageSaved",(function(t){return e.handleMessageSaved(t)})).listen("FriendRequest",(function(t){return e.handleFriendRequest(t)})).listen("ConfirmFriendRequest",(function(t){return e.handleConfirmFriendRequest(t)}))},e.prototype.setupPostChannel=function(){var e=this;this.postId&&(console.log("Post_id is present"),console.log("post.".concat(this.postId)),window.Echo.join("post.".concat(this.postId)).joining((function(t){return e.handleUserJoining(t)})).here((function(t){return e.handleUsersHere(t)})).leaving((function(t){return e.handleUserLeaving(t)})))},e.prototype.handleMessageSaved=function(e){var t=document.querySelector(".profile-block-content");t&&(parseInt(t.getAttribute("data-friend")||"0",10)===e.userFrom.id?this.appendMessage(t,e):this.updateMessageCounter())},e.prototype.appendMessage=function(e,t){var n,r='\n      <div class="message-wrapper">\n        <div class="message-header">\n          <a href="'.concat(t.url,'" class="message-header-link">\n            <img src="').concat(null===(n=t.userFrom.profile)||void 0===n?void 0:n.avatar,'" class="message-header-avatar">\n          </a>\n        </div>\n        <div class="message-body">\n          <div class="message-body-header">\n            <a href="').concat(t.url,'" class="message-header-name">').concat(t.userFrom.username,'</a>\n            <div class="message-body-header-time">').concat(t.createdAt,'</div>\n          </div>\n          <div class="message-body-content">').concat(t.text,"</div>\n        </div>\n      </div>\n    ");e.insertAdjacentHTML("beforeend",r)},e.prototype.updateMessageCounter=function(){var e,t=document.querySelector(".messages-count");if(t){var n=parseInt((null===(e=t.textContent)||void 0===e?void 0:e.replace("+",""))||"0",10)+1;t.textContent="+".concat(n),t instanceof HTMLElement&&"none"===t.style.display&&this.fadeInElement(t)}},e.prototype.handleFriendRequest=function(e){var t,n=document.querySelector(".friend-requests");if(n){var r=parseInt((null===(t=n.textContent)||void 0===t?void 0:t.replace("+",""))||"0",10);n.textContent="+".concat(r+1),n instanceof HTMLElement&&"none"===n.style.display&&this.fadeInElement(n),this.appendFriendRequest(e)}},e.prototype.appendFriendRequest=function(e){var t,n=null===(t=document.querySelector(".users-element-request:last-of-type"))||void 0===t?void 0:t.parentElement;if(n){var r='\n      <li class="users-element-request">\n        <a href="'.concat(e.urlSender,'" class="profile-link">\n          <img src="').concat(e.avatar,'" class="avatar-image">\n        </a>\n        <a href="').concat(e.urlSender,'" class="profile-name">').concat(e.sender.username,'</a>\n        <div class="friend-request-button right" data-id="').concat(e.sender.id,'" data-username="').concat(e.friend.username,'">\n          <svg version="1.1" class="public-user-uncheck" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 15.381 15.381" style="enable-background:new 0 0 15.381 15.381;" xml:space="preserve">\n            <g>\n              <path d="M12.016,15.381h-8.65c-1.558,0-2.826-1.268-2.826-2.825v-9.73C0.54,1.268,1.808,0,3.366,0h8.65\n                c1.558,0,2.825,1.268,2.825,2.826v9.73C14.841,14.114,13.574,15.381,12.016,15.381z M3.366,1.305\n                c-0.839,0-1.521,0.683-1.521,1.521v9.73c0,0.838,0.683,1.521,1.521,1.521h8.65c0.839,0,1.521-0.684,1.521-1.521v-9.73\n                c0-0.839-0.683-1.521-1.521-1.521C12.016,1.305,3.366,1.305,3.366,1.305z"></path>\n            </g>\n          </svg>\n        </div>\n      </li>\n    ');n.insertAdjacentHTML("beforeend",r)}},e.prototype.handleConfirmFriendRequest=function(e){var t=document.querySelector(".friend-id-".concat(e.sender.id));if(t){var n=t.lastElementChild;if(n){n.insertAdjacentHTML("afterend",'\n      <div class="confirmed right">\n        <svg version="1.1" class="checked-friend-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 26 26">\n          <path d="m.3,14c-0.2-0.2-0.3-0.5-0.3-0.7s0.1-0.5 0.3-0.7l1.4-1.4c0.4-0.4 1-0.4 1.4,0l.1,.1 5.5,5.9c0.2,0.2 0.5,0.2 0.7,0l13.4-13.9h0.1v-8.88178e-16c0.4-0.4 1-0.4 1.4,0l1.4,1.4c0.4,0.4 0.4,1 0,1.4l0,0-16,16.6c-0.2,0.2-0.4,0.3-0.7,0.3-0.3,0-0.5-0.1-0.7-0.3l-7.8-8.4-.2-.3z"></path>\n        </svg>\n      </div>\n    '),n.remove()}}},e.prototype.handleUserJoining=function(e){var t=document.querySelector(".article-readers-body");if(t){var n='\n      <div class="post-reader flex flex-v-center" id="user-'.concat(e.id,'">\n        <a href="').concat(e.url,'" class="user-avatar-link">\n          <img src="').concat(e.avatar,'" class="user-avatar" alt="').concat(e.username,'">\n        </a>\n        <a href="').concat(e.url,'" class="post-author">').concat(e.username,"</a>\n      </div>\n    ");t.insertAdjacentHTML("beforeend",n)}},e.prototype.handleUsersHere=function(e){var t=document.querySelector(".article-readers-body");!t||t.children.length>0||e.forEach((function(e){var n='\n        <div class="post-reader flex flex-v-center" id="user-'.concat(e.id,'">\n          <a href="').concat(e.url,'" class="user-avatar-link">\n            <img src="').concat(e.avatar,'" class="user-avatar circle" alt="').concat(e.username,'">\n          </a>\n          <a href="').concat(e.url,'" class="post-author">').concat(e.username,"</a>\n        </div>\n      ");t.insertAdjacentHTML("beforeend",n)}))},e.prototype.handleUserLeaving=function(e){var t=document.getElementById("user-".concat(e.id));t&&t.remove()},e.prototype.fadeInElement=function(e,t){void 0===t&&(t=500),e.style.display="",e.style.opacity="0";var n=0,r=16/t;requestAnimationFrame((function t(){(n+=r)>=1?e.style.opacity="1":(e.style.opacity=n.toString(),requestAnimationFrame(t))}))}}()},4600:()=>{function e(){var e=this.nextElementSibling;if(e instanceof HTMLElement){var t=!e.classList.contains("expanded");e.classList.toggle("expanded",t);var n=this.querySelector(".caret-down");window.setTimeout((function(){null==n||n.classList.toggle("rotate-svg",t)}),200)}}function t(){document.querySelectorAll(".expanded-item").forEach((function(t){t.addEventListener("click",e)}))}"loading"!==document.readyState?t():document.addEventListener("DOMContentLoaded",t)},6240:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.CommentController=void 0;var a=n(9607),i=n(6890),s=n(422),c=function(){function e(){this.domService=new a.DOMService,this.commentService=new i.CommentService(this.domService),this.commentUI=new s.CommentUI(this.domService),this.initializeEvents()}return e.prototype.initializeEvents=function(){var e=this.domService.getElement("commentButton"),t=this.domService.getElement("replyButton");null==e||e.addEventListener("click",this.handleCommentSubmit.bind(this)),null==t||t.addEventListener("click",this.handleReplyClick.bind(this))},e.prototype.handleCommentSubmit=function(e){return r(this,void 0,void 0,(function(){var t,n,r,a,i,s;return o(this,(function(o){switch(o.label){case 0:if(e.preventDefault(),t=this.domService.getElement("wrapper"),n=this.domService.getElement("textEditor"),!t||!n)return[2];r={post:this.domService.getDatasetValue(t,"post"),level:this.domService.getDatasetValue(t,"level"),parent:this.domService.getDatasetValue(t,"parent"),message:n.innerHTML},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.commentService.submitComment(r)];case 2:return a=o.sent(),this.commentUI.clearEditor(),i=this.commentUI.createCommentHtml(a),this.commentUI.insertComment(i,this.commentService.getTargetElement()),this.commentService.setTargetElement(null),[3,4];case 3:return s=o.sent(),console.error("Error submitting comment:",s),[3,4];case 4:return[2]}}))}))},e.prototype.handleReplyClick=function(e){var t=e.currentTarget,n=parseInt(this.domService.getDatasetValue(t,"level","0"))+1,r=this.domService.getDatasetValue(t,"parent"),o=this.domService.getElement("wrapper");o&&(o.dataset.level=n.toString(),o.dataset.parent=r),this.commentUI.scrollToCommentElement();var a=t.closest(".comment-item");if(a){for(var i=parseInt(this.domService.getDatasetValue(a,"level","0"))+1,s=a;s;){var c=s.nextElementSibling;if(!c)break;if(parseInt(this.domService.getDatasetValue(c,"level","0"))<i)break;s=c}this.commentService.setTargetElement(s||a)}},e}();t.CommentController=c},6890:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.CommentService=void 0;var o=function(){function e(e){this.domService=e,this.targetElement=null}return e.prototype.submitComment=function(e){return n(this,void 0,void 0,(function(){var t,n;return r(this,(function(r){switch(r.label){case 0:return t=new FormData,Object.entries(e).forEach((function(e){var n=e[0],r=e[1];return t.append(n,r)})),[4,fetch("/comment/store",{method:"POST",body:t,headers:{"X-CSRF-TOKEN":this.domService.getCsrfToken()}})];case 1:if(!(n=r.sent()).ok)throw new Error("Failed to submit comment");return[2,n.json()]}}))}))},e.prototype.setTargetElement=function(e){this.targetElement=e},e.prototype.getTargetElement=function(){return this.targetElement},e}();t.CommentService=o},422:(e,t,n)=>{"use strict";t.__esModule=!0,t.CommentUI=void 0;var r=n(8827),o=function(){function e(e){this.domService=e,this.htmlElementCreator=new r.HtmlElementCreator}return e.prototype.clearEditor=function(){var e=this.domService.getElement("textEditor");e&&(localStorage.removeItem("post-body"),e.innerHTML="<div><br /></div>")},e.prototype.createCommentHtml=function(e){return"\n      <div class='comment-item level-".concat(e.level,"' data-level='").concat(e.level,"'>\n        <div class='header'>\n          <a href='").concat(e.url,"' class='user-avatar-link header-item'>\n            <img src='").concat(e.avatar,"' class='user-avatar' alt='").concat(e.username,"' /> \n          </a>\n          <a href='").concat(e.url,"' class='post-author header-item'>").concat(e.username,"</a>\n          <div class='right'>").concat(e.created_at,"</div>\n        </div>\n        <div class='body'>\n          <p>").concat(e.message,"</p>\n        </div>\n      </div>\n    ")},e.prototype.insertComment=function(e,t){void 0===t&&(t=null);var n=this.htmlElementCreator.createFromString(e),r=this.domService.getElement("commentsWrapper");n&&(t?t.insertAdjacentElement("afterend",n):r&&r.insertAdjacentElement("afterend",n))},e.prototype.scrollToCommentElement=function(){var e=this.domService.getElement("addCommentElement");e&&window.scrollTo({top:e.offsetTop,behavior:"smooth"})},e}();t.CommentUI=o},9404:function(){var e,t=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},r=this;null===(e=document.querySelector(".request-list"))||void 0===e||e.addEventListener("click",(function(e){e.target.closest(".friend-request-button")&&function(e){t(r,void 0,void 0,(function(){var t,r,o,a,i,s,c,u,l,d,f,h,p,m;return n(this,(function(n){switch(n.label){case 0:t=e.target,r=t.dataset,o=r.id,a=r.username,n.label=1;case 1:return n.trys.push([1,3,,4]),(i=new FormData).append("id",o),i.append("username",a),s=null===(p=document.querySelector('meta[name="csrf-token"]'))||void 0===p?void 0:p.content,[4,fetch("/user/friends/requests",{method:"POST",headers:{"X-CSRF-TOKEN":s||""},body:i})];case 2:if(!n.sent().ok)throw new Error("Network response was not ok");return t.innerHTML='\n            <svg version="1.1" class="public-user-check" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 26 26">\n                <path d="m.3,14c-0.2-0.2-0.3-0.5-0.3-0.7s0.1-0.5 0.3-0.7l1.4-1.4c0.4-0.4 1-0.4 1.4,0l.1,.1 5.5,5.9c0.2,0.2 0.5,0.2 0.7,0l13.4-13.9h0.1v-8.88178e-16c0.4-0.4 1-0.4 1.4,0l1.4,1.4c0.4,0.4 0.4,1 0,1.4l0,0-16,16.6c-0.2,0.2-0.4,0.3-0.7,0.3-0.3,0-0.5-0.1-0.7-0.3l-7.8-8.4-.2-.3z"></path>\n            </svg>\n        ',(c=document.querySelector(".friend-requests"))&&(u=t.parentElement)?(l=c,d=parseInt((null===(m=l.textContent)||void 0===m?void 0:m.replace("+",""))||"0"),f=function(e,t){e.style.opacity="1";var n=setInterval((function(){parseFloat(e.style.opacity)>0?e.style.opacity=(parseFloat(e.style.opacity)-.1).toString():(clearInterval(n),e.remove(),null==t||t())}),50)},(d-=1)>0?(f(u),l.textContent="+".concat(d)):(f(c),f(u,(function(){var e=document.querySelector(".request-list-element");null==e||e.style.setProperty("display","block","important"),null==e||e.style.setProperty("opacity","1","important")}))),[3,4]):[2];case 3:return h=n.sent(),console.error("Error processing friend request:",h),[3,4];case 4:return[2]}}))}))}(e)}))},8827:(e,t)=>{"use strict";t.__esModule=!0,t.HtmlElementCreator=void 0;var n=function(){function e(){}return e.prototype.createFromString=function(e){if(!(null==e?void 0:e.trim()))throw new Error("HTML string cannot be empty");var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstChild},e}();t.HtmlElementCreator=n},9607:(e,t)=>{"use strict";t.__esModule=!0,t.DOMService=void 0;var n=function(){function e(){this.elements={},this.csrfToken="",this.initializeElements(),this.initializeCsrfToken()}return e.prototype.initializeElements=function(){this.elements={wrapper:document.querySelector(".add-comment-wrapper"),commentButton:document.querySelector(".add-comment-button"),replyButton:document.querySelector(".reply-button"),textEditor:document.querySelector(".text-editor-body"),commentsWrapper:document.querySelector(".comments-wrapper"),animateElement:document.querySelector("html, body"),addCommentElement:document.getElementById("add-comment")}},e.prototype.initializeCsrfToken=function(){var e=document.querySelector('meta[name="csrf-token"]');this.csrfToken=(null==e?void 0:e.getAttribute("content"))||""},e.prototype.getElement=function(e){var t;return null!==(t=this.elements[e])&&void 0!==t?t:null},e.prototype.getCsrfToken=function(){return this.csrfToken},e.prototype.getDatasetValue=function(e,t,n){var r;return void 0===n&&(n=""),null!==(r=null==e?void 0:e.dataset[t])&&void 0!==r?r:n},e}();t.DOMService=n},9342:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},n=function(){function n(){this.savedRange=null,this.editor=this.getElement(".text-editor-body"),this.selectItemSub=this.getElement(".select-item-sub"),this.imageSelectItemSub=this.getElement(".image-select-item-sub"),this.selectItemInput=this.getElement(".select-item-input"),this.imageSelectItemInput=this.getElement(".image-select-item-input"),this.imageItem=this.getElement(".image-item"),this.uploadImage=this.getElement("#upload_image_form_input"),this.bodyInput=this.getElement("#body"),this.init()}return n.prototype.getElement=function(e){var t=document.querySelector(e);if(!t)throw new Error("Element not found: ".concat(e));return t},n.prototype.init=function(){this.loadContent(),this.setupAutoSave(),this.setupEventListeners()},n.prototype.loadContent=function(){var e=localStorage.getItem("post-body");e&&"undefined"!==e&&(this.editor.innerHTML=e);var t=this.bodyInput.value;t&&(this.editor.innerHTML=t)},n.prototype.setupAutoSave=function(){var e=this;setInterval((function(){localStorage.setItem("post-body",e.editor.innerHTML)}),1e4)},n.prototype.setupEventListeners=function(){var e=this,t=this.getElement(".link-item");t.addEventListener("mouseenter",(function(){return e.toggleSubMenu(e.selectItemSub,!0)})),t.addEventListener("mouseleave",(function(){return e.toggleSubMenu(e.selectItemSub,!1)})),this.imageItem.addEventListener("mouseenter",(function(){return e.toggleSubMenu(e.imageSelectItemSub,!0)})),this.imageItem.addEventListener("mouseleave",(function(){return e.toggleSubMenu(e.imageSelectItemSub,!1)})),this.setupCommandButtons(),this.setupImageHandling(),this.getElement(".submit-post-form").addEventListener("click",this.handleFormSubmit.bind(this)),this.getElement(".submit-edit-post-form").addEventListener("click",this.handleEditFormSubmit.bind(this)),this.editor.addEventListener("focusout",this.saveSelection.bind(this))},n.prototype.toggleSubMenu=function(e,t){e.style.display=t?"block":"none"},n.prototype.setupCommandButtons=function(){var e=this;Object.entries({".heading_2":{command:"formatBlock",value:"h2"},".heading_3":{command:"formatBlock",value:"h3"},".paragraph":{command:"formatBlock",value:"p"},".bold-item":{command:"bold"},".italic-item":{command:"italic"},".broken-item":{command:"unlink"},".ordered-item":{command:"insertOrderedList"},".unordered-item":{command:"insertUnorderedList"},".quotes-item":{command:"formatBlock",value:"BLOCKQUOTE"},".indent-item":{command:"indent"},".outdent-item":{command:"outdent"},".undo-item":{command:"undo"},".redo-item":{command:"redo"}}).forEach((function(t){var n=t[0],r=t[1],o=r.command,a=r.value;e.getElement(n).addEventListener("click",(function(){return e.executeCommand(o,a)}))})),this.getElement(".delete-item").addEventListener("click",(function(){return e.selectItemInput.value=""})),this.getElement(".image-delete-item").addEventListener("click",(function(t){t.stopImmediatePropagation(),e.imageSelectItemInput.value=""})),this.getElement(".checked-item").addEventListener("click",(function(){var t=e.selectItemInput.value;e.selectItemInput.value="",e.toggleSubMenu(e.selectItemSub,!1),e.executeCommand("createLink",t)})),this.getElement(".image-checked-item").addEventListener("click",(function(t){t.stopImmediatePropagation();var n=e.imageSelectItemInput.value;if(e.imageSelectItemInput.value="",n){var r=e.editor.querySelectorAll("img");if(r.length)r[r.length-1].alt=n,e.toggleSubMenu(e.imageSelectItemSub,!1)}})),this.imageSelectItemSub.addEventListener("click",(function(e){return e.stopImmediatePropagation()}))},n.prototype.setupImageHandling=function(){var e=this;this.imageItem.addEventListener("click",(function(){return e.uploadImage.click()})),this.uploadImage.addEventListener("change",(function(){var t,n=null===(t=e.uploadImage.files)||void 0===t?void 0:t[0];if(n){var r=new FormData;r.append("upload_image_form_input",n);var o=e.uploadImage.dataset.type;"post"!==o&&"comment"!==o||r.append("type",o);var a=e.getElement(".add-comment-wrapper").dataset.username;a&&r.append("username",a),e.uploadImageToServer(r)}}))},n.prototype.uploadImageToServer=function(n){var r;return e(this,void 0,void 0,(function(){var e,o,a,i;return t(this,(function(t){switch(t.label){case 0:if(t.trys.push([0,3,,4]),!(e=null===(r=document.querySelector('meta[name="csrf-token"]'))||void 0===r?void 0:r.content))throw new Error("CSRF token not found");return[4,fetch("/user/image/upload",{method:"POST",body:n,headers:{"X-CSRF-TOKEN":e}})];case 1:if(!(o=t.sent()).ok)throw new Error("HTTP error! status: ".concat(o.status));return[4,o.text()];case 2:return a=t.sent(),this.executeCommand("insertImage",a),[3,4];case 3:return i=t.sent(),console.error("Error uploading image:",i),[3,4];case 4:return[2]}}))}))},n.prototype.executeCommand=function(e,t){void 0===t&&(t=null),this.editor.focus(),this.restoreSelection(),document.execCommand(e,!1,null===t?void 0:t)},n.prototype.restoreSelection=function(){if(this.savedRange){var e=window.getSelection();e?(e.removeAllRanges(),e.addRange(this.savedRange)):document.selection&&this.savedRange.select()}},n.prototype.saveSelection=function(){var e=window.getSelection();e&&e.rangeCount>0?this.savedRange=e.getRangeAt(0):document.selection&&(this.savedRange=document.selection.createRange())},n.prototype.handleFormSubmit=function(e){e.preventDefault(),this.bodyInput.value=this.editor.innerHTML,this.cleanupStorage(),this.getElement("#create-post-form").submit()},n.prototype.handleEditFormSubmit=function(e){e.preventDefault(),this.bodyInput.value=this.editor.innerHTML;var t=this.getElement("#caption"),n=this.editor.children[0];t.value=n?"<p>".concat(n.innerHTML,"</p>"):"",this.cleanupStorage(),this.getElement("#create-post-form").submit()},n.prototype.cleanupStorage=function(){localStorage.removeItem("post-body"),localStorage.removeItem("title-post-image-url")},n}();document.addEventListener("DOMContentLoaded",(function(){new n}))},5274:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};document.querySelectorAll(".image-wrapper").forEach((function(n){n.addEventListener("click",(function(n){n.target.matches(".image-block-footer-button")&&function(n){var r,o;e(this,void 0,void 0,(function(){var e,a,i,s,c,u,l,d,f,h;return t(this,(function(t){switch(t.label){case 0:if(!(null==(e=n.target)?void 0:e.dataset))return[2];if(a=e.dataset,i=a.id,s=a.username,!i||!s)return[2];(c=new FormData).append("id",i),c.append("username",s),t.label=1;case 1:if(t.trys.push([1,4,,5]),!(u=null===(r=document.querySelector('meta[name="csrf-token"]'))||void 0===r?void 0:r.content))throw new Error("CSRF token not found");return[4,fetch("/user/favorite/add",{method:"POST",body:c,headers:{"X-CSRF-TOKEN":u}})];case 2:if(!(l=t.sent()).ok)throw new Error("HTTP error! status: ".concat(l.status));return[4,l.text()];case 3:return d=t.sent(),(f=null===(o=e.closest(".image-block-footer-button"))||void 0===o?void 0:o.previousElementSibling)&&(f.innerHTML=d),[3,5];case 4:return h=t.sent(),console.error("Error adding to favorites:",h),[3,5];case 5:return[2]}}))}))}(n)}))}))},4158:()=>{document.querySelectorAll(".alert").forEach((function(e){e.style.transition="opacity 0.5s",e.style.opacity="0",setTimeout((function(){return e.remove()}),5e3)}))},5025:()=>{document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".image-block").forEach((function(e){e.addEventListener("click",(function(t){var n=e.querySelector("img");if(n){var r=n.dataset.url;r&&function(e){var t=document.querySelector("main");if(t){var n=document.createElement("div");n.className="fullpage-block";var r=document.createElement("img");r.className="fullpage-image",r.src=e,r.alt="Full size image";var o=document.createElement("div");o.className="fullpage-messages",n.append(r,o),t.appendChild(n)}}(r)}}))}))}))},7051:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".image-block-top-button").forEach((function(n){n.addEventListener("click",(function(){return function(n){var r,o;return e(this,void 0,void 0,(function(){var e,a,i,s,c,u,l,d,f,h,p;return t(this,(function(t){switch(t.label){case 0:if(e=n.dataset,a=e.id,i=e.username,s=e.album,c=e.path,u=e.thumbnail,l=null===(r=document.querySelector('meta[name="csrf-token"]'))||void 0===r?void 0:r.content,!(a&&i&&s&&c&&u&&l))return console.error("Missing required data attributes or CSRF token"),[2];t.label=1;case 1:return t.trys.push([1,6,,7]),(d=new URLSearchParams).append("id",a),d.append("username",i),d.append("album",s),d.append("path",c),d.append("thumbnail",u),[4,fetch("/user/image/delete?".concat(d.toString()),{method:"DELETE",headers:{"X-CSRF-TOKEN":l}})];case 2:return(f=t.sent()).ok?[4,f.text()]:[3,4];case 3:return"ok"===t.sent()&&(h=null===(o=n.parentElement)||void 0===o?void 0:o.parentElement)&&h.remove(),[3,5];case 4:console.error("Delete request failed:",f.status),t.label=5;case 5:return[3,7];case 6:return p=t.sent(),console.error("Error deleting image:",p),[3,7];case 7:return[2]}}))}))}(n)}))}))}))},1809:(e,t,n)=>{"use strict";t.__esModule=!0;var r=n(3328),o=n(8278);r.Chart.register.apply(r.Chart,r.registerables),r.Chart.register(o.default);var a={primary:"#573EA4",secondary:"#EF4747",tertiary:"#BF3985",success:"#39BF39",warning:"#EFD247",palette:["#EF4747","#EFD247","#573EA4","#39BF39","#EF9347","#EFEF47","#7A369F","#2B8F8F","#EFB747","#ABDF43","#BF3985","#3C5AA0"]},i={1:"Январь",2:"Февраль",3:"Март",4:"Апрель",5:"Май",6:"Июнь",7:"Июль",8:"Август",9:"Сентябрь",10:"Октябрь",11:"Ноябрь",12:"Декабрь"},s=function(e,t,n,o){var a=document.getElementById(e);return a?new r.Chart(a,{type:t,data:n,options:o}):(console.error("Element with id ".concat(e," not found")),null)};document.addEventListener("DOMContentLoaded",(function(){var e,t,n=window.dashboardData||{};(e=n).posts&&(s("postChart","bar",{labels:(t=e.posts,t.map((function(e){var t=i[e.month]||"Месяц ".concat(e.month);return"".concat(t," ").concat(e.year)}))),datasets:[{label:"Количество опубликованных статей",data:e.posts.map((function(e){return e.count})),backgroundColor:a.primary,datalabels:{color:"#FFFFFF"}}]},{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}),void 0!==e.commentsVerified&&void 0!==e.commentsNotVerified&&s("commentsChart","doughnut",{labels:["Одобренные комментарии","Неодобренные комментарии"],datasets:[{data:[e.commentsVerified,e.commentsNotVerified],backgroundColor:[a.primary,a.secondary],datalabels:{color:"#FFFFFF"}}]}),e.datesQuery&&e.usersQuery&&e.sessionQuery&&e.hitsQuery&&s("usersChart","line",{labels:e.datesQuery,datasets:[{label:"Количество пользователей",data:e.usersQuery,backgroundColor:a.primary,borderColor:a.primary,fill:"origin",datalabels:{display:!1}},{label:"Количество сессий",data:e.sessionQuery,backgroundColor:a.secondary,borderColor:a.secondary,fill:"origin",datalabels:{display:!1}},{label:"Количество взаимодействий",data:e.hitsQuery,backgroundColor:a.tertiary,borderColor:a.tertiary,fill:"origin",datalabels:{display:!1}}]},{scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}),e.countryQueryLabels&&e.countryQueryData&&s("countryChart","doughnut",{labels:e.countryQueryLabels,datasets:[{data:e.countryQueryData,backgroundColor:a.palette,datalabels:{color:"#FFFFFF"}}]}),e.cityQueryLabels&&e.cityQueryData&&s("cityChart","doughnut",{labels:e.cityQueryLabels,datasets:[{data:e.cityQueryData,backgroundColor:a.palette.slice(0,10),datalabels:{color:"#FFFFFF"}}]}))}))},8072:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},n=function(){function n(){}return n.init=function(){this.loadStoredImage(),this.setupEventListeners()},n.loadStoredImage=function(){var e=localStorage.getItem(this.STORAGE_KEYS.URL);e&&(this.createImageElement(e),document.querySelector(this.ELEMENTS.imageInput).value=e)},n.setupEventListeners=function(){var n,r,o=this;null===(n=document.querySelector(this.ELEMENTS.uploadButton))||void 0===n||n.addEventListener("click",(function(){var e;null===(e=document.querySelector(o.ELEMENTS.fileInput))||void 0===e||e.click()})),null===(r=document.querySelector(this.ELEMENTS.fileInput))||void 0===r||r.addEventListener("change",(function(){return e(o,void 0,void 0,(function(){return t(this,(function(e){switch(e.label){case 0:return[4,this.handleImageUpload()];case 1:return e.sent(),[2]}}))}))}))},n.handleImageUpload=function(){var n,r;return e(this,void 0,void 0,(function(){var e,o,a,i;return t(this,(function(t){switch(t.label){case 0:if(e=document.querySelector(this.ELEMENTS.fileInput),!(null===(n=null==e?void 0:e.files)||void 0===n?void 0:n.length))return[2];o=null===(r=document.querySelector(this.ELEMENTS.imageInput))||void 0===r?void 0:r.value,a=e.files[0],t.label=1;case 1:return t.trys.push([1,5,,6]),o?[4,this.deleteExistingImage(o)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.uploadNewImage(a)];case 4:return t.sent(),[3,6];case 5:return i=t.sent(),console.error("Image upload failed:",i),[3,6];case 6:return[2]}}))}))},n.deleteExistingImage=function(n){return e(this,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:return e=localStorage.getItem(this.STORAGE_KEYS.PATH),r=new URLSearchParams({url:n,path:e||""}),[4,fetch("/admin/posts/image-destroy?".concat(r),{method:"DELETE",headers:this.getHeaders()})];case 1:return t.sent(),[2]}}))}))},n.uploadNewImage=function(n){return e(this,void 0,void 0,(function(){var e,r,o;return t(this,(function(t){switch(t.label){case 0:return(e=new FormData).append("post_upload",n),[4,fetch("/admin/posts/image-upload",{method:"POST",body:e,headers:this.getHeaders()})];case 1:if(!(r=t.sent()).ok)throw new Error("Upload failed with status ".concat(r.status));return[4,r.json()];case 2:return o=t.sent(),this.clearExistingImage(),this.createImageElement(o.url),this.updateFormAndStorage(o),[2]}}))}))},n.clearExistingImage=function(){var e;null===(e=document.querySelector(this.ELEMENTS.uploadedImage))||void 0===e||e.remove()},n.createImageElement=function(e){var t,n=document.createElement("img");n.src=e,n.className="uploaded-image",null===(t=document.querySelector(this.ELEMENTS.blockWrapper))||void 0===t||t.after(n)},n.updateFormAndStorage=function(e){var t=document.querySelector(this.ELEMENTS.imageInput);t&&(t.value=e.url),localStorage.setItem(this.STORAGE_KEYS.URL,e.url),e.path&&localStorage.setItem(this.STORAGE_KEYS.PATH,e.path)},n.getHeaders=function(){var e,t=new Headers,n=null===(e=document.querySelector(this.ELEMENTS.csrfToken))||void 0===e?void 0:e.getAttribute("content");return n&&t.append("X-CSRF-TOKEN",n),t},n.STORAGE_KEYS={URL:"title-post-image-url",PATH:"title-post-image-path"},n.ELEMENTS={blockWrapper:".block-wrapper",uploadButton:".post_upload_image_button",fileInput:"#post_upload_image_input",imageInput:"#image",uploadedImage:".uploaded-image",csrfToken:'meta[name="csrf-token"]'},n}();document.addEventListener("DOMContentLoaded",(function(){n.init()}))},844:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},n=function(){function n(){}return n.init=function(){var e=this;document.addEventListener("click",(function(t){var n=t.target.closest(".comment-publish-button");n&&e.handlePublishClick(n)}))},n.handlePublishClick=function(n){return e(this,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:e=n.dataset.id,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.togglePublishStatus(e)];case 2:return t.sent(),this.toggleButtonIcon(n),[3,4];case 3:return r=t.sent(),console.error("Failed to toggle publish status:",r),[3,4];case 4:return[2]}}))}))},n.togglePublishStatus=function(n){return e(this,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:return(e=new URLSearchParams).append("id",n),[4,fetch("/admin/comments/publish",{method:"PUT",body:e,headers:this.getHeaders()})];case 1:if(!(r=t.sent()).ok)throw new Error("HTTP error! status: ".concat(r.status));return[2]}}))}))},n.toggleButtonIcon=function(e){var t=e.querySelector(".comment-unpublish-svg");e.innerHTML=t?this.PUBLISH_ICON:this.UNPUBLISH_ICON},n.getHeaders=function(){var e,t=new Headers,n=null===(e=document.querySelector('meta[name="csrf-token"]'))||void 0===e?void 0:e.getAttribute("content");return n&&t.append("X-CSRF-TOKEN",n),t},n.PUBLISH_ICON='\n        <svg version="1.1" class="comment-publish-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" enable-background="new 0 0 26 26">\n            <path d="m.3,14c-0.2-0.2-0.3-0.5-0.3-0.7s0.1-0.5 0.3-0.7l1.4-1.4c0.4-0.4 1-0.4 1.4,0l.1,.1 5.5,5.9c0.2,0.2 0.5,0.2 0.7,0l13.4-13.9h0.1v-8.88178e-16c0.4-0.4 1-0.4 1.4,0l1.4,1.4c0.4,0.4 0.4,1 0,1.4l0,0-16,16.6c-0.2,0.2-0.4,0.3-0.7,0.3-0.3,0-0.5-0.1-0.7-0.3l-7.8-8.4-.2-.3z"/>\n        </svg>\n    ',n.UNPUBLISH_ICON='\n        <svg version="1.1" class="comment-unpublish-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.381 15.381" style="enable-background:new 0 0 15.381 15.381" xml:space="preserve">\n            <g>\n                <path d="M12.016,15.381h-8.65c-1.558,0-2.826-1.268-2.826-2.825v-9.73C0.54,1.268,1.808,0,3.366,0h8.65c1.558,0,2.825,1.268,2.825,2.826v9.73C14.841,14.114,13.574,15.381,12.016,15.381z M3.366,1.305c-0.839,0-1.521,0.683-1.521,1.521v9.73c0,0.838,0.683,1.521,1.521,1.521h8.65c0.839,0,1.521-0.684,1.521-1.521v-9.73c0-0.839-0.683-1.521-1.521-1.521C12.016,1.305,3.366,1.305,3.366,1.305z"/>\n            </g>\n        </svg>\n    ',n}();document.addEventListener("DOMContentLoaded",(function(){n.init()}))},1282:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},n=function(){function n(){}return n.init=function(){var e=this;document.addEventListener("click",(function(t){var n=t.target.closest(".publish");n&&(t.preventDefault(),e.handlePublishClick(n))}))},n.handlePublishClick=function(n){return e(this,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:if(!(e=n.dataset.id))return console.error("No post ID found on button"),[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.togglePublishStatus(e)];case 2:return t.sent(),this.toggleButtonIcon(n),[3,4];case 3:return r=t.sent(),console.error("Failed to toggle publish status:",r),[3,4];case 4:return[2]}}))}))},n.togglePublishStatus=function(n){return e(this,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:return(e=new URLSearchParams).append("id",n),[4,fetch("/admin/posts/publish",{method:"PUT",body:e,headers:this.getHeaders()})];case 1:if(!(r=t.sent()).ok)throw new Error("HTTP error! status: ".concat(r.status));return[2]}}))}))},n.toggleButtonIcon=function(e){var t=e.querySelector(".unpublish-svg");e.innerHTML=t?this.PUBLISH_ICON:this.UNPUBLISH_ICON},n.getHeaders=function(){var e,t=new Headers,n=null===(e=document.querySelector('meta[name="csrf-token"]'))||void 0===e?void 0:e.getAttribute("content");return n&&t.append("X-CSRF-TOKEN",n),t},n.PUBLISH_ICON='\n        <svg version="1.1" class="publish-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" enable-background="new 0 0 26 26">\n            <path d="m.3,14c-0.2-0.2-0.3-0.5-0.3-0.7s0.1-0.5 0.3-0.7l1.4-1.4c0.4-0.4 1-0.4 1.4,0l.1,.1 5.5,5.9c0.2,0.2 0.5,0.2 0.7,0l13.4-13.9h0.1v-8.88178e-16c0.4-0.4 1-0.4 1.4,0l1.4,1.4c0.4,0.4 0.4,1 0,1.4l0,0-16,16.6c-0.2,0.2-0.4,0.3-0.7,0.3-0.3,0-0.5-0.1-0.7-0.3l-7.8-8.4-.2-.3z"/>\n        </svg>\n    ',n.UNPUBLISH_ICON='\n        <svg version="1.1" class="unpublish-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.381 15.381" style="enable-background:new 0 0 15.381 15.381" xml:space="preserve">\n            <g>\n                <path d="M12.016,15.381h-8.65c-1.558,0-2.826-1.268-2.826-2.825v-9.73C0.54,1.268,1.808,0,3.366,0h8.65c1.558,0,2.825,1.268,2.825,2.826v9.73C14.841,14.114,13.574,15.381,12.016,15.381z M3.366,1.305c-0.839,0-1.521,0.683-1.521,1.521v9.73c0,0.838,0.683,1.521,1.521,1.521h8.65c0.839,0,1.521-0.684,1.521-1.521v-9.73c0-0.839-0.683-1.521-1.521-1.521C12.016,1.305,3.366,1.305,3.366,1.305z"/>\n            </g>\n        </svg>\n    ',n}();document.addEventListener("DOMContentLoaded",(function(){n.init()}))},4157:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},n=function(){function n(){}return n.init=function(){var n=this;document.addEventListener("click",(function(r){return e(n,void 0,void 0,(function(){var e,n;return t(this,(function(t){switch(t.label){case 0:return e=r.target,(n=e.closest(".rating-block"))?(r.preventDefault(),[4,this.handleRatingClick(n)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))},n.handleRatingClick=function(n){return e(this,void 0,void 0,(function(){var e,r,o,a;return t(this,(function(t){switch(t.label){case 0:if(e=n.getAttribute("data-id"),r=n.querySelector("p"),!e||!r)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.submitRating(e)];case 2:return o=t.sent(),r.textContent=o,[3,4];case 3:return a=t.sent(),console.error("Rating submission failed:",a),[3,4];case 4:return[2]}}))}))},n.submitRating=function(n){return e(this,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:return(e=new FormData).append("id",n),[4,fetch("/rating/post",{method:"POST",body:e,headers:this.getHeaders()})];case 1:if(!(r=t.sent()).ok)throw new Error("HTTP error! status: ".concat(r.status));return[4,r.text()];case 2:return[2,t.sent()]}}))}))},n.getHeaders=function(){var e,t=new Headers,n=null===(e=document.querySelector('meta[name="csrf-token"]'))||void 0===e?void 0:e.getAttribute("content");return n&&t.append("X-CSRF-TOKEN",n),t},n}();document.addEventListener("DOMContentLoaded",(function(){n.init()}))},1971:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},n=function(){function n(){}return n.init=function(){var n=this,r=document.querySelector(".text-editor-body");r&&r.addEventListener("keydown",(function(r){return e(n,void 0,void 0,(function(){return t(this,(function(e){switch(e.label){case 0:return r.ctrlKey&&"Enter"===r.key?(r.preventDefault(),[4,this.handleMessageSubmit()]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},n.handleMessageSubmit=function(){return e(this,void 0,void 0,(function(){var e,n,r,o,a,i,s;return t(this,(function(t){switch(t.label){case 0:if(!(e=document.querySelector(".profile-block-content")))return[2];if(n=e.getAttribute("data-username"),r=e.getAttribute("data-friend"),o=document.querySelector(".text-editor-body"),!n||!r||!o)return[2];a=o.innerHTML,o.innerHTML="<div><br></div>",localStorage.removeItem("post-body"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.sendMessage(n,r,a)];case 2:return i=t.sent(),this.displayNewMessage(i),this.hideWelcomeChat(),[3,4];case 3:return s=t.sent(),console.error("Message sending failed:",s),[3,4];case 4:return[2]}}))}))},n.sendMessage=function(n,r,o){return e(this,void 0,void 0,(function(){var e,a;return t(this,(function(t){switch(t.label){case 0:return(e=new FormData).append("username",n),e.append("friend_id",r),e.append("message",o),[4,fetch("/user/messages/store",{method:"POST",body:e,headers:this.getHeaders()})];case 1:if(!(a=t.sent()).ok)throw new Error("HTTP error! status: ".concat(a.status));return[4,a.json()];case 2:return[2,t.sent()]}}))}))},n.displayNewMessage=function(e){var t='\n            <div class="message-wrapper">\n                <div class="message-header">\n                    <a href="'.concat(e.url,'" class="message-header-link">\n                        <img src="').concat(e.avatar,'" class="message-header-avatar circle">\n                    </a>\n                </div>\n                <div class="message-body">\n                    <div class="message-body-header">\n                        <a href="').concat(e.url,'" class="message-header-name">').concat(e.username,'</a>\n                        <div class="message-body-header-time">').concat(e.time,'</div>\n                    </div>\n                    <div class="message-body-content">\n                        ').concat(e.text,"\n                    </div>\n                </div>\n            </div>\n        "),n=document.querySelector(".profile-block-content");n&&n.insertAdjacentHTML("beforeend",t)},n.hideWelcomeChat=function(){var e=document.querySelector(".welcome-chat");e&&"block"===window.getComputedStyle(e).display&&(e.classList.add("fade-out"),setTimeout((function(){e.style.display="none"}),200))},n.getHeaders=function(){var e,t=new Headers,n=null===(e=document.querySelector('meta[name="csrf-token"]'))||void 0===e?void 0:e.getAttribute("content");return n&&t.append("X-CSRF-TOKEN",n),t},n}();document.addEventListener("DOMContentLoaded",(function(){n.init()}));var r=document.createElement("style");r.textContent="\n    .fade-out {\n        opacity: 0;\n        transition: opacity 200ms ease-in-out;\n    }\n",document.head.appendChild(r)},9916:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},n=function(){function n(){}var r;return n.init=function(){var e=this;document.addEventListener("click",(function(t){var n=t.target.closest(".request-friend");n&&(t.preventDefault(),e.handleFriendRequest(n))}))},n.handleFriendRequest=function(n){return e(this,void 0,void 0,(function(){var e,r,o;return t(this,(function(t){switch(t.label){case 0:if(e=n.dataset.friend,r=n.dataset.username,!e||!r)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.sendFriendRequest(e,r)];case 2:return t.sent(),this.replaceWithWaitingButton(n),[3,4];case 3:return o=t.sent(),console.error("Friend request failed:",o),[3,4];case 4:return[2]}}))}))},n.sendFriendRequest=function(n,r){return e(this,void 0,void 0,(function(){var e,o;return t(this,(function(t){switch(t.label){case 0:return(e=new FormData).append("friend",n),e.append("username",r),[4,fetch("/user/friends/add",{method:"POST",body:e,headers:this.getHeaders()})];case 1:if(!(o=t.sent()).ok)throw new Error("HTTP error! status: ".concat(o.status));return[2]}}))}))},n.replaceWithWaitingButton=function(e){var t=document.createElement("div");t.innerHTML=this.WAITING_BUTTON_HTML.trim();var n=t.firstChild;n&&e.replaceWith(n)},n.getHeaders=function(){var e,t=new Headers,n=null===(e=document.querySelector('meta[name="csrf-token"]'))||void 0===e?void 0:e.getAttribute("content");return n&&t.append("X-CSRF-TOKEN",n),t},r=n,n.HOURGLASS_ICON='\n        <svg version="1.1" class="hourglass-friend-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60" style="enable-background:new 0 0 60 60" xml:space="preserve">\n            <g>\n                <path d="M54,58h-3v-4h-5V43.778c0-2.7-1.342-5.208-3.589-6.706L31.803,30l10.608-7.072C44.658,21.43,46,18.922,46,16.222V6h5V2h3\n                c0.552,0,1-0.447,1-1s-0.448-1-1-1h-3h-1H10H9H6C5.448,0,5,0.447,5,1s0.448,1,1,1h3v4h5v10.222c0,2.7,1.342,5.208,3.589,6.706\n                L28.197,30l-10.608,7.072C15.342,38.57,14,41.078,14,43.778V54H9v4H6c-0.552,0-1,0.447-1,1s0.448,1,1,1h3h1h40h1h3\n                c0.552,0,1-0.447,1-1S54.552,58,54,58z M18.698,21.264C17.009,20.137,16,18.252,16,16.222V6h28v10.222\n                c0,2.03-1.009,3.915-2.698,5.042L30,28.798L18.698,21.264z M16,43.778c0-2.03,1.009-3.915,2.698-5.042L30,31.202l11.302,7.534\n                C42.991,39.863,44,41.748,44,43.778V54H16V43.778z"/>\n            </g>\n        </svg>\n    ',n.WAITING_BUTTON_HTML='\n        <div class="waiting" title="Ожидание подтверждения.">\n            <div class="svg-wrapper">\n                '.concat(r.HOURGLASS_ICON,'\n            </div>\n            <div class="button-title">Ожидание</div>\n        </div>\n    '),n}();document.addEventListener("DOMContentLoaded",(function(){n.init()}))},5774:()=>{var e=function(){function e(){this.smallNav=document.querySelector(".small-nav"),this.smallFirstLevel=document.querySelector(".small-first-level"),this.initEventListeners()}return e.prototype.initEventListeners=function(){var e,t,n,r=this;null===(e=document.querySelector(".menu-icon-svg"))||void 0===e||e.addEventListener("click",(function(){r.hideSmallNav(),r.fadeInFirstLevel()})),null===(t=document.querySelector(".small-delete-button"))||void 0===t||t.addEventListener("click",(function(){r.hideFirstLevel(),r.fadeInSmallNav()})),null===(n=document.querySelector(".small-deleted-item"))||void 0===n||n.addEventListener("click",(function(){r.hideFirstLevel(),r.fadeInSmallNav()}))},e.prototype.hideSmallNav=function(){this.smallNav&&(this.smallNav.style.display="none")},e.prototype.fadeInFirstLevel=function(){var e=this;if(this.smallFirstLevel){this.smallFirstLevel.style.display="block",this.smallFirstLevel.style.opacity="0";var t=0;!function n(){t+=.05,e.smallFirstLevel&&(e.smallFirstLevel.style.opacity=t.toString()),t<1&&requestAnimationFrame(n)}()}},e.prototype.hideFirstLevel=function(){this.smallFirstLevel&&(this.smallFirstLevel.style.display="none")},e.prototype.fadeInSmallNav=function(){var e=this;if(this.smallNav){this.smallNav.style.display="block",this.smallNav.style.opacity="0";var t=0;!function n(){t+=.05,e.smallNav&&(e.smallNav.style.opacity=t.toString()),t<1&&requestAnimationFrame(n)}()}},e}();document.addEventListener("DOMContentLoaded",(function(){new e}))},6058:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},n=function(){function n(){}return n.init=function(){var e=this;document.addEventListener("click",(function(t){t.target.closest(".test-airlock")&&(t.preventDefault(),e.fetchUserData())}))},n.fetchUserData=function(){return e(this,void 0,void 0,(function(){var e,n,r;return t(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,fetch(this.API_ENDPOINT,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"})];case 1:if(!(e=t.sent()).ok)throw new Error("HTTP error! status: ".concat(e.status));return[4,e.json()];case 2:return n=t.sent(),console.log(n.slug),[3,4];case 3:return(r=t.sent())instanceof Error&&(r.message.includes("401")?console.log("Unauthorized"):console.error("API request failed:",r)),[3,4];case 4:return[2]}}))}))},n.API_ENDPOINT="/api/user",n}();document.addEventListener("DOMContentLoaded",(function(){n.init()}))},4863:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0;var a=n(9697),i=function(){function e(){}return e.init=function(){var e,t,n=this;null===(e=document.querySelector(".upload-button"))||void 0===e||e.addEventListener("click",(function(){var e;null===(e=document.getElementById("change-avatar-input"))||void 0===e||e.click()})),null===(t=document.getElementById("change-avatar-input"))||void 0===t||t.addEventListener("change",(function(e){var t,r=e.target;(null===(t=r.files)||void 0===t?void 0:t.length)&&n.handleFileUpload(r.files[0],r.dataset.username||"")}))},e.handleFileUpload=function(e,t){return r(this,void 0,void 0,(function(){var n,r,a,i;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(n=new FormData).append("avatar_upload",e),n.append("username",t),[4,this.getCropData(e)];case 1:return r=o.sent(),Object.entries(r).forEach((function(e){var t=e[0],r=e[1];n.append(t,r.toString())})),[4,this.uploadAvatar(n)];case 2:return a=o.sent(),this.updateAvatarImage(a),[3,4];case 3:return i=o.sent(),console.error("Avatar upload failed:",i),[3,4];case 4:return[2]}}))}))},e.getCropData=function(e){return r(this,void 0,void 0,(function(){var t=this;return o(this,(function(n){return[2,new Promise((function(n,r){var o=new Image;o.src=URL.createObjectURL(e),o.onload=function(){URL.revokeObjectURL(o.src),console.log("Original dimensions:",o.width,o.height),a.default.crop(o,t.AVATAR_SIZE).then((function(e){console.log("Crop dimensions:",e.topCrop),n({x:e.topCrop.x,y:e.topCrop.y,width:e.topCrop.width,height:e.topCrop.height})})).catch(r)},o.onerror=function(){return r(new Error("Failed to load image"))}}))]}))}))},e.uploadAvatar=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,fetch("/user/avatar/upload",{method:"POST",body:e,headers:this.getHeaders()})];case 1:if(!(t=n.sent()).ok)throw new Error("Upload failed with status ".concat(t.status));return[4,t.text()];case 2:return[2,n.sent()]}}))}))},e.updateAvatarImage=function(e){var t=document.querySelector(".avatar-inner img");t&&(t.src=e)},e.getHeaders=function(){var e,t=new Headers,n=null===(e=document.querySelector('meta[name="csrf-token"]'))||void 0===e?void 0:e.getAttribute("content");return n&&t.append("X-CSRF-TOKEN",n),t},e.AVATAR_SIZE={width:200,height:200},e}();document.addEventListener("DOMContentLoaded",(function(){i.init()}))},8480:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},n=function(){function n(){}return n.init=function(){var n=this;document.addEventListener("click",(function(r){return e(n,void 0,void 0,(function(){var e;return t(this,(function(t){switch(t.label){case 0:return(e=r.target.closest(".confirm-delete-button"))?(r.preventDefault(),[4,this.handleDeleteConfirmation(e)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))},n.handleDeleteConfirmation=function(n){return e(this,void 0,void 0,(function(){var e,r,o,a,i;return t(this,(function(t){switch(t.label){case 0:if(e=n.dataset.id,r=n.dataset.message,o=n.dataset.button,!e||!r||!o)return console.error("Missing required data attributes"),[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.sendDeleteRequest(e)];case 2:return"ok"===(a=t.sent()).status&&this.showSuccessMessage(r,o,a.url),[3,4];case 3:return i=t.sent(),console.error("Delete failed:",i),[3,4];case 4:return[2]}}))}))},n.sendDeleteRequest=function(n){return e(this,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:return(e=new FormData).append("id",n),[4,fetch("/admin/rips",{method:"POST",body:e,headers:this.getHeaders()})];case 1:if(!(r=t.sent()).ok)throw new Error("HTTP error! status: ".concat(r.status));return[4,r.json()];case 2:return[2,t.sent()]}}))}))},n.showSuccessMessage=function(e,t,n){var r=document.querySelector(".main-content-wrapper");if(r){r.querySelectorAll(".flex").forEach((function(e){return e.classList.add("hidden")}));var o=document.createElement("div");o.className="flex flex-justify-space",o.innerHTML='\n            <p class="lockout-message">'.concat(e,'</p>\n            <a href="').concat(n,'" class="button confirm-button">').concat(t,"</a>\n        "),r.appendChild(o)}},n.getHeaders=function(){var e,t=new Headers,n=null===(e=document.querySelector('meta[name="csrf-token"]'))||void 0===e?void 0:e.getAttribute("content");return n&&t.append("X-CSRF-TOKEN",n),t},n}();document.addEventListener("DOMContentLoaded",(function(){n.init()}))},2137:function(){var e=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},t=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},n=function(){function n(){}return n.init=function(){var n=this;document.addEventListener("click",(function(r){return e(n,void 0,void 0,(function(){var e,n;return t(this,(function(t){switch(t.label){case 0:return e=r.target,(n=e.closest(".unban-user-button"))?(r.preventDefault(),[4,this.handleUnbanRequest(n)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))},n.handleUnbanRequest=function(n){return e(this,void 0,void 0,(function(){var e,r,o;return t(this,(function(t){switch(t.label){case 0:if(e=n.dataset.id,r=n.dataset.message,!e||!r)return console.error("Missing required data attributes"),[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.sendUnbanRequest(e)];case 2:return"ok"===t.sent()&&this.updateUI(n,r),[3,4];case 3:return o=t.sent(),console.error("Unban request failed:",o),[3,4];case 4:return[2]}}))}))},n.sendUnbanRequest=function(n){return e(this,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:return e=new URLSearchParams({id:n}),[4,fetch("/admin/rips?".concat(e),{method:"DELETE",headers:this.getHeaders()})];case 1:if(!(r=t.sent()).ok)throw new Error("HTTP error! status: ".concat(r.status));return[4,r.text()];case 2:return[2,t.sent()]}}))}))},n.updateUI=function(e,t){e.remove();var n=document.querySelector(".user-info");if(n){var r=document.createElement("div");r.className="button info-button right",r.textContent=t,n.appendChild(r)}},n.getHeaders=function(){var e,t=new Headers,n=null===(e=document.querySelector('meta[name="csrf-token"]'))||void 0===e?void 0:e.getAttribute("content");return n&&t.append("X-CSRF-TOKEN",n),t},n}();document.addEventListener("DOMContentLoaded",(function(){n.init()}))},3611:()=>{},7020:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[170,898],(()=>(t(5427),t(3611))));e.O()}]);